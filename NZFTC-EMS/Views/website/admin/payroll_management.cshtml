@model IEnumerable<NZFTC_EMS.Models.payroll_model>
@{
    Layout = ViewData["Layout"]?.ToString();
    ViewData["Title"] = "Payroll Management";

    var q = ViewBag.Search as string;
    var min = ViewBag.Min as decimal?;
    var max = ViewBag.Max as decimal?;
}

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
<link rel="stylesheet" href="~/css/portal-StyleSheet.css" />

<div class="container-fluid py-4">

    <div class="d-flex justify-content-between align-items-center mb-3">
        <h3 class="mb-0 fw-bold">Payroll Management</h3>
        <div class="d-flex gap-2">

            <a href="/payroll_management/seed-test" class="btn btn-secondary">
                <i class="fa-solid fa-database"></i> Seed Test Data
            </a>
            <a href="/payroll_management/export-excel" class="btn btn-success">
                <i class="fa-solid fa-file-csv"></i> Export CSV
            </a>
            <a href="/payroll_management/export-pdf" class="btn btn-danger">
                <i class="fa-solid fa-file-lines"></i> Export TXT
            </a>
            <button class="btn btn-primary" data-bs-toggle="collapse" data-bs-target="#addForm">
                <i class="fa-solid fa-plus"></i> Add Payroll
            </button>
        </div>
    </div>


    <form method="get" class="row g-2 mb-4 align-items-center">
        <div class="col-md-4">
            <input name="q" class="form-control" placeholder="Search Employee Name" value="@q" />
        </div>
        <div class="col-md-2">
            <input name="min" type="number" step="0.01" class="form-control" placeholder="Min Salary" value="@(min ?? null)" />
        </div>
        <div class="col-md-2">
            <input name="max" type="number" step="0.01" class="form-control" placeholder="Max Salary" value="@(max ?? null)" />
        </div>
        <div class="col-md-2">
            <button class="btn btn-outline-primary w-100" type="submit">Filter</button>
        </div>
    </form>


    <div id="addForm" class="collapse mb-4">
        <form asp-action="Add" method="post" class="p-4 bg-light rounded shadow-sm">
            <div class="row g-3">
                <div class="col-md-4">
                    <label class="form-label fw-bold">Employee Name</label>
                    <input name="employee_name" class="form-control" placeholder="Full name" required />
                </div>
                <div class="col-md-3">
                    <label class="form-label fw-bold">Base Salary</label>
                    <input name="base_salary" type="number" step="0.01" class="form-control" required />
                </div>
                <div class="col-md-3">
                    <label class="form-label fw-bold">Deductions</label>
                    <input name="deductions" type="number" step="0.01" class="form-control" required />
                </div>
                <div class="col-md-2 d-flex align-items-end">
                    <button class="btn btn-success w-100">Save</button>
                </div>
            </div>
        </form>
    </div>


    <div class="table-responsive shadow-sm">
        <table class="table table-bordered align-middle text-center">
            <thead class="table-primary">
                <tr>
                    <th>ID</th>
                    <th>Employee Name</th>
                    <th>Base Salary ($)</th>
                    <th>Deductions ($)</th>
                    <th>Net Salary ($)</th>
                </tr>
            </thead>
            <tbody>
                @if (Model != null && Model.Any())
                {
                    foreach (var p in Model)
                    {
                        <tr>
                            <td>@p.payroll_id</td>
                            <td>@p.employee_name</td>
                            <td>@p.base_salary.ToString("F2")</td>
                            <td>@p.deductions.ToString("F2")</td>
                            <td class="fw-bold text-success">@p.net_salary.ToString("F2")</td>
                        </tr>
                    }
                }
                else
                {
                    <tr>
                        <td colspan="5" class="text-muted">No payroll records found.</td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
