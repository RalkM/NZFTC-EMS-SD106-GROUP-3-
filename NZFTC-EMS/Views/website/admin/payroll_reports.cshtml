@model List<NZFTC_EMS.ViewModels.Payroll.PayrollReportVM>
@{
    Layout = "~/Views/Shared/_portal.cshtml";
}

<div class="page-container">

    <!-- PAGE HEADER -->
    <div class="header-row d-flex justify-content-between align-items-center mb-4">
        <h2 class="page-title fw-bold">Payroll Reports</h2>
    </div>

    @if (TempData["Success"] != null)
    {
        <div class="alert alert-success">@TempData["Success"]</div>
    }

    <!-- SUMMARY CARDS -->
    <div class="row g-4 mb-4">

        <div class="col-md-3">
            <div class="settings-card card shadow-sm border-0">
                <div class="card-body">
                    <h6 class="text-muted">Total Gross Paid</h6>
                    <h4 class="fw-bold text-primary">
                        $@Model.Sum(x => x.GrossPaid).ToString("N2")
                    </h4>
                </div>
            </div>
        </div>

        <div class="col-md-3">
            <div class="settings-card card shadow-sm border-0">
                <div class="card-body">
                    <h6 class="text-muted">Total Tax Paid</h6>
                    <h4 class="fw-bold text-danger">
                        $@Model.Sum(x => x.TaxPaid).ToString("N2")
                    </h4>
                </div>
            </div>
        </div>

        <div class="col-md-3">
            <div class="settings-card card shadow-sm border-0">
                <div class="card-body">
                    <h6 class="text-muted">Total KiwiSaver (Employee)</h6>
                    <h4 class="fw-bold text-success">
                        $@Model.Sum(x => x.KiwiSaverEmployeePaid).ToString("N2")
                    </h4>
                </div>
            </div>
        </div>

        <div class="col-md-3">
            <div class="settings-card card shadow-sm border-0">
                <div class="card-body">
                    <h6 class="text-muted">Total ACC Levy</h6>
                    <h4 class="fw-bold text-secondary">
                        $@Model.Sum(x => x.ACCPaid).ToString("N2")
                    </h4>
                </div>
            </div>
        </div>

    </div>

    <!-- PAYROLL REPORT TABLE -->
    <div class="card shadow-sm border-0">
        <div class="card-header text-white fw-semibold"
             style="background-color:#1E4DB7; border-radius:6px 6px 0 0;">
            Payroll Breakdown by Employee
        </div>

        <div class="table-responsive">
            <table class="table table-hover styled-table align-middle mb-0">
                <thead class="table-light">
                    <tr>
                        <th>Employee</th>
                        <th>Department</th>
                        <th>Gross Paid</th>
                        <th>Tax Paid</th>
                        <th>KiwiSaver (Emp)</th>
                        <th>ACC Levy</th>
                        <th>Net Paid</th>
                        <th>Pay Runs</th>
                    </tr>
                </thead>

                <tbody>
                    @foreach (var p in Model)
                    {
                        <tr>
                            <td>@p.EmployeeName</td>
                            <td>@p.Department</td>

                            <td class="fw-semibold text-primary">
                                $@p.GrossPaid.ToString("N2")
                            </td>

                            <td class="text-danger">
                                $@p.TaxPaid.ToString("N2")
                            </td>

                            <td class="text-success">
                                $@p.KiwiSaverEmployeePaid.ToString("N2")
                            </td>

                            <td class="text-secondary">
                                $@p.ACCPaid.ToString("N2")
                            </td>

                            <td class="fw-bold text-success">
                                $@p.NetPaid.ToString("N2")
                            </td>

                            <td>@p.PayRuns</td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>

</div>

@section Scripts {
    <script src="~/js/payroll_admin.js"></script>
}

<style>
    .page-container {
        max-width: 1150px;
        margin: auto;
    }

    .settings-card .card-body {
        padding: 20px 22px;
    }

    .styled-table th {
        font-weight: 600;
    }

    .styled-table td {
        padding-top: 14px !important;
        padding-bottom: 14px !important;
    }
</style>
