@using NZFTC_EMS.Controllers
@model IEnumerable<LeaveRequestVm>

@{
   Layout = ViewData["Layout"]?.ToString();
    ViewData["Title"] = "My Leave Requests";
    var selectedStatus = ViewBag.Status as string ?? "All";
}

<link rel="stylesheet" href="~/css/portal-StyleSheet.css" />
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />

<div class="container mt-4">

    <div class="d-flex justify-content-between align-items-center mb-3 flex-wrap gap-2">
        <h3 class="fw-bold">Apply for Leave</h3>
        <a class="btn btn-primary shadow-sm"
           asp-controller="leave_management"
           asp-action="File">
            New Leave Request
        </a>
    </div>


    <div class="d-flex gap-4 mb-4 flex-wrap">
        <div class="p-3 border rounded bg-light text-center shadow-sm" style="min-width:180px;">
            <h6 class="fw-bold text-secondary">Annual Leave</h6>
            <h3 class="fw-bold text-dark">35.5 hrs</h3>
        </div>
        <div class="p-3 border rounded bg-light text-center shadow-sm" style="min-width:180px;">
            <h6 class="fw-bold text-secondary">Sick Leave</h6>
            <h3 class="fw-bold text-dark">24 hrs</h3>
        </div>
    </div>


    <form method="get" class="d-flex gap-2 mb-4 flex-wrap align-items-center" style="max-width:400px;">
        <label class="fw-bold text-secondary">Filter by Status:</label>
        <select name="status" class="form-select" style="max-width:180px;">
            <option value="All" selected="@("All" == selectedStatus)">All</option>
            <option value="Pending" selected="@("Pending" == selectedStatus)">Pending</option>
            <option value="Approved" selected="@("Approved" == selectedStatus)">Approved</option>
            <option value="Declined" selected="@("Declined" == selectedStatus)">Declined</option>
        </select>
        <button class="btn btn-outline-secondary" type="submit">Apply</button>
    </form>

  
    <div class="table-responsive shadow-sm">
        <table class="table table-bordered align-middle text-center">
            <thead class="table-primary">
                <tr>
                    <th>Leave Type</th>
                    <th>Leave Period</th>
                    <th>Reason</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
@if (!(Model?.Any() ?? false))
{
    <tr><td colspan="7" class="text-center text-muted">No leave requests found.</td></tr>
}
else
{
    foreach (var r in Model)
    {
        <tr>
            <td>@r.EmployeeName</td>
            <td>@r.LeaveType</td>
            <td>@r.StartDate.ToString("dd/MM/yyyy")</td>
            <td>@r.EndDate.ToString("dd/MM/yyyy")</td>
            <td>@r.Reason</td>
            <td>@r.Status</td>
            <td>@r.RequestedAt.ToString("dd/MM/yyyy HH:mm")</td>
        </tr>
    }
}
</tbody>

        </table>
    </div>
</div>
